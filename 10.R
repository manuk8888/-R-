# Задача 1: Загрузка данных
games <- read.csv("vgsales.csv")

# Задача 2: Фильтрация данных
games <- games[games$Global_Sales <= 5, ]

# Задача 3: Построение гистограммы для общего числа продаж
hist(games$Global_Sales, 
     main = "Гистограмма общего числа продаж видеоигр",
     xlab = "Общее число продаж (в миллионах)",
     ylab = "Частота",
     col = "lightblue",
     border = "darkblue")

# Задача 4: Интерпретация гистограммы
# Распределение скошено вправо, так как большинство значений сосредоточено в левой части графика.
# Чаще всего встречаются игры с небольшим числом продаж (менее 1 миллиона), а игры с большим числом продаж встречаются реже.

# Задача 5: Добавление вертикальных линий для среднего и медианного значения
mean_sales <- mean(games$Global_Sales)
median_sales <- median(games$Global_Sales)

abline(v = mean_sales, col = "red", lty = 1, lwd = 2)
abline(v = median_sales, col = "green", lty = 2, lwd = 2)

legend("topright", 
       legend = c("Среднее", "Медиана"), 
       col = c("red", "green"), 
       lty = c(1, 2), 
       lwd = 2)

# Среднее значение больше медианного, что подтверждает скошенность распределения вправо.

# Задача 6: Ответ на вопрос
# Использование различных начертаний линий может быть более рациональным, чем использование различных цветов, 
# когда график будет печататься в черно-белом формате или когда необходимо подчеркнуть различия между линиями, 
# не полагаясь на цветовые различия.

# Задача 7: Построение гистограммы для числа продаж в Европе
hist(games$EU_Sales, 
     main = "Гистограмма числа продаж в Европе",
     xlab = "Число продаж в Европе (в миллионах)",
     ylab = "Частота",
     col = "lightgreen",
     border = "darkgreen")

# Распределение числа продаж в Европе также скошено вправо, как и общее число продаж.
# Это говорит о том, что большинство игр продаются в Европе в небольших количествах, 
# а игры с большим числом продаж встречаются реже.

# Задача 8: Построение столбчатой диаграммы для платформ
platform_counts <- table(games$Platform)
barplot(platform_counts, 
        main = "Распределение игр по платформам",
        xlab = "Платформа",
        ylab = "Количество игр",
        col = "lightcoral",
        las = 2)

# Наиболее популярной платформой является PS2.

# Задача 9: Изменение цветов столбцов
colors <- rep(c("lightcoral", "lightblue", "lightgreen", "lightyellow", "lightpink"), length.out = length(platform_counts))
barplot(platform_counts, 
        main = "Распределение игр по платформам",
        xlab = "Платформа",
        ylab = "Количество игр",
        col = colors,
        las = 2)

# Задача 10: Корректировка вертикальной оси
barplot(platform_counts, 
        main = "Распределение игр по платформам",
        xlab = "Платформа",
        ylab = "Количество игр",
        col = colors,
        las = 2,
        ylim = c(0, max(platform_counts) * 1.1))

# Задача 11: Построение круговой диаграммы для жанров
genre_counts <- table(games$Genre)
genre_percent <- round(100 * genre_counts / sum(genre_counts), 1)
pie(genre_counts, 
    main = "Распределение игр по жанрам",
    col = rainbow(length(genre_counts)),
    labels = paste(names(genre_counts), " (", genre_percent, "%)", sep = ""))
legend("topright", 
       legend = names(genre_counts), 
       fill = rainbow(length(genre_counts)))

# Задача 12: Построение линейного графика для скорости скачивания
torr_pace <- c(0.3, 0.6, 1.5, 1.7, 1.2, 0.8, 1.7, 1.8, 2.0, 2.5,
               2.2, 2.7, 3.3, 3.1, 3.5, 3.0, 3.2, 3.3, 3.8, 4.0,
               3.7, 3.9, 3.5, 3.3, 3.2, 2.8, 2.5, 2.2, 1.8, 1.5,
               1.4, 1.5, 1.2, 1.6, 1.8, 2.0, 2.2, 1.9, 1.8, 1.4,
               1.2, 1.0, 0.9, 0.8, 1.1, 1.2, 1.3, 1.0, 0.8, 0.7,
               1.1, 1.3, 1.5, 1.7, 1.6, 1.8, 1.9, 2.0, 1.5, 1.1)

plot(torr_pace, 
     type = "l", 
     main = "Динамика скорости скачивания файла",
     xlab = "Время (секунды)",
     ylab = "Скорость скачивания (МБ/с)",
     col = "blue",
     lwd = 2)
grid()